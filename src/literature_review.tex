\chapter{Literature Review}
\label{sec:literature_review}

\chaptertoc{}

\begin{chapterabstract}
  This chapter presents some examples of the use of numerical phantoms from literature.
  It represents a review of the contemporary literature in \ac{dMRI} simulation, highlighting the state of the art and presenting some weaknesses which this project aims to address. 
\end{chapterabstract}




% \subsection*{Analytical Solutions}
% As mentioned in Section \ref{sec:analytical}, analytical approaches are limited in terms of the geometrical complexity that they can capture.
% The hybrid method of Rensonnet et al.\ is an approach that takes advantage of the convenience of analytical solutions in simple geometries and the flexibility of MC simulations in more complex geometries.
 

\section{Numerical Solutions}
\label{sec:app_numerical_solutions}
Many of the studies presenting a numerical solution are focused on the validation of the technique and improvements to various algorithms rather than the direct use of the technique involving numerical phantoms.

One application of \ac{FDM} solutions of the Bloch-Torrey equations is in the simulation of \ac{dMRI} signals from histological images.
For example, Chin et al.\ \cite{Chin2002} simulate the signal from segmented histological images of mouse spinal cord white matter, showing that the fast and slow components of a biexponential decay of diffusion attenuation do not arise from a contribution from each of the intra and extracellular components.
Hwang et al.\ \cite{Hwang2003} extend this technique to 3D, showing that their \ac{FDM} solutions agree well with analytical solutions for hexagonally packed cylinders. 

Xu et al.\ \cite{Xu2007} develop a matrix based \ac{FDM}, also testing their solution on hexagonally packed cylinders, showing a reduction in error compared to a conventional FDM.
This \ac{FDM} is used by the same group to investigate the sensitivity of \ac{dMRI} to intracellular structure \cite{Xu2009}.
A numerical phantom of cells represented as densely packed spheres with spherical nuclei at the centre of each sphere.
The FDM is used to show that an \ac{OGSE} sequence is more sensitive to changes in the nucleus size than a \ac{PGSE} sequence.
Similarly, Xu et al.\ \cite{Xu2014} use histology based \ac{FDM} simulations to investigate the efficacy of an axon diameter technique based on an \ac{OGSE} sequence. They show that the \ac{OGSE} technique is able to distinguish axons of a lower diameter than traditional \ac{PGSE} techniques. 

% Most studies presenting an FEM solution are focused on the validation of the technique rather than the application of the technique and its use in numerical phantoms.
% Hagsl\"att et al. \cite{Hagslatt2003}, Moroney et al. \cite{Moroney2013}, and Beltrachnini et al. \cite{Beltrachini2016} all show an effective implementation of an FEM solution with various improvements in the stability and accuracy of the solutions.
% Van Nguyen et al.\ \cite{Nguyen2014} implement a 3D FEM solution of the Bloch-Torrey equation and apply it to three example questions in dMRI.
% \todo{add more on numerical solutions}
The first example of an \ac{FEM} solution known to the author is presented by Hagsl\"att et al.\ \cite{Hagslatt2003}.
In this study, rather than solving the \ac{BT} equation, the \ac{FEM} is used to solve for the diffusion propagator \cite{Callaghan1991,Price1997}. From the diffusion propagator, the diffusion attenuated signal is calculated based on an assumption of infinitely narrow gradient pulses.
A good agreement is shown between simulation and theoretical solutions for a range of simple geometries (parallel plates, a lamellar system and  hexagonally packed cylinders).

More studies have recently begun investigating diffusion simulation using \acp{FEM}.
Moroney et al.\ \cite{Moroney2013} present an \ac{FEM} solution of the \ac{BT} equation without the relaxtion and flow terms for numerical analysis of \ac{dMRI} experiments in the short gradient pulse limit. \ac{FEM} results are compared to analytical solutions and \ac{MC} simulations in simple geometries, showing that the \ac{FEM} is more accurate than \ac{MC} simulations, whilst taking less time to run.

Nguyen et al.\ \cite{Nguyen2014} also present an \ac{FEM} solution of the standard \ac{BT} equation, showing its application to diffusion simulation with more general gradient waveforms.
The \ac{FEM} solution is shown to be more accurate in some simple geometries than a finite volume method, with second order accuracy in both the spatial and temporal domains.
Three example applications to questions in \ac{dMRI} are demonstrated using this \ac{FEM}
\cite{Nguyen2014}.
One shows that an infinitely thin membrane can be used to approximate a thick membrane. The second shows that the \ac{ADC} approaches the value predicted by mathematical homegenisation for long diffusion times. Finally, a model of a neuron is presented as a spherical body, with cylindrical axons and dendrites potruding. The \ac{ADC} is shown to approach a steady state faster with a smaller neuronal body.

Beltrachini et al.\ \cite{Beltrachini2016} present a solution of the generalised \ac{BT} equation, extending the \ac{FEM} of Nguyen et al.\ \cite{Nguyen2014} to include the relaxation and flow terms. This \ac{FEM} improves on some of the restrictions in the \ac{FEM}, making the simulations more stable through the use of an implicit scheme that is stable for coarser discretisations without compromising the validity of the result. 


\section{Monte-Carlo - Packages}
\label{sec:app_monte_carlo_packages}
Historically, most studies utilising \ac{MC} simulation used in-house developed \ac{MC} simulation software \cite{Lipinski1990, Szafer1995,Stanisz1997, Duh2001}, however in more recent years and as the complexity of situations possible to simulate has grown, a range of \ac{MC} simulation packages have been released for public use.

Hall and Alexander \cite{Hall2009} introduced \ac{MC} simulation as part of the Camino diffusion MRI toolkit \cite{Cook2006} in the context of simulating swelling cylinders as a model of the effect of ischaemic stroke, however the \ac{MC} framework is very general and can be used to simulate any arbitrary substrate from simple geometric constructs to complex 3D meshes. 

Balls and Frank \cite{Balls2009} present DiffSim, a dMRI simulation framework which embeds the MCell \cite{Stiles1996,Stiles2001, Kerr2008} cellular microphysiology simulator within an \ac{MRI} simulator for synthesising the \ac{dMRI} signal.
DiffSim is used to simulate myelinated white matter \cite{Baxter2013}, showing that an analytical solution model by Sen and Basser \cite{Sen2005} holds for an \ac{SGP} approximation or long diffusion time, however with more realistic pulse sequence parameters, the numerical simulations show lower anisotropy than the analytical model. 

Landman et al.\ \cite{Landman2010} developed the DW-MRI \ac{RWS} showing, as an example of its flexibility and reproducibility, a range of geometrical models for white matter damage, including healthy straight cylinders, bulging cylinders, crimped cylinders and broken cylinders.

Yeh et al.\ \cite{Yeh2013} present \ac{DMS}, showing a range of diffusion substrates ranging from simple parallel uniform cylinders to more complex undulating, beading or crossing arrangements of fibres.
A recent extension of \ac{DMS} shows more complex white matter numerical phantom including orientation dispersion, tortuosity, beading and nodes of Ranvier \cite{Ginsburger2018}, however the range of orientation dispersion and axon densities achieved does not reach typical \emph{in vivo} values.
As of the writing of this review, the \ac{DMS} software package has not been publicly released. 

\section{Monte-Carlo - Numerical Phantoms}
\label{sec:app_monte_carlo_numerical_phantoms}
The above packages, as well as \ac{dMRI} simulation software developed in-house in various research groups, have been used to investigate the diffusion signal in many different numerical phantoms. 

A common target of microstructure imaging is the estimation of axonal diameter and density.
As mentioned above, \ac{FDM} approaches have been used to investigate this \cite{Chin2002,Xu2014}, whilst this has been the subject of \ac{MC} simulation studies as well.
Alexander et al.\ \cite{Alexander2010} use Camino to simulate a series of numerical phantoms of parallel cylinders with radii drawn from a Gamma distribution for the validation of a technique for orientationally invariant indices of axon diameter and density.

Recently Nilsson et al.\ \cite{Nilsson2017}, investigated the theoretical resolution limit for cylinder diameter estimation using diffusion MRI. Analytic expressions based on the Gaussian phase distribution approximation \cite{Price1997} were used for the intracellular signal and validated with \ac{MC} simulations to determine a $d_{min}$, the diameter below which a cylinder cannot be differentiated from a cylinder with diameter approaching zero. The resolution limit for clinical scanners was found to be between 4 - 8 $\mu$m.
This suggests a limitation on the level of microstructural detail that can be estimated using current clinical \ac{MRI} machines.

% Zhang et al.\ \cite{Zhang2011} extend this technique to include orientation dispersion, and then refine the technique to only estimate neurite orientation dispersion and density (NODDI) \cite{Zhang2012}. All of these techniques are validated using MC simulations on numerical phantoms of cylinders with varying densities and orientation dispersion introduced.\todo{make sure this actually true} 

Another problem commonly investigated using numerical phantoms is that of exchange between the intra and extracellular compartments of tissues.
Permeability is difficult to control and vary in physical or biological phantoms, so numerical phantoms offer a unique tool with which to explore permeability and exchange models.

Nilsson et al.\ \cite{Nilsson2009, Nilsson2010} and Fieremans et al.\ \cite{Fieremans2010} investigate the K\"arger model \cite{KARGER1988}, a model for exchange between two signal bearing compartments.
These three studies all use similar numerical phantoms made of straight cylinders in which there is some probability that on encountering a barrier, the spin will pass through the barrier, exchanging spins between the compartments.

In their first study, Nilsson et al.\ \cite{Nilsson2009} use simulations and experimental data to draw the conclusion that it is necessary to include exchange in a model containing two compartments, one of which is restricted. 
Fieremans et al.\ \cite{Fieremans2010} show that the K\"arger model is able to describe the signal for long diffusion times and sufficiently impermeable membranes, however at larger permeabilities, the K\"arger model underestimates the value of the permeability.
Nilsson et al.\ also investigate the effectiveness of the K\"arger model at estimating the intracellular water fraction, showing that the K\"arger model has a negative bias, underestimating the intracellular water fraction by up to 25\% when there is high permeabilty when compared to a computational model made by building a database of simulated signals \cite{Nilsson2010}.
% These studies suggest that the simple K\"arger model is sufficient to explain the dMRI signal in certain situations, however in general it is in sufficient.

Nilsson et al.\ \cite{Nilsson2012} also investigate the importance of axonal undulation on diffusion MRI measurements.
In this experiment, numerical phantoms consisting of axons with either sinusoidal or helical undulations were used in \ac{MC} simulations to investigate the impact on a range of \ac{dMRI} measured parameters.
Nilsson et al.\ show that undulation affects essentially all of the parameters they tested derived from \ac{dMRI}, for instance, undulation results in an overestimation of axonal diameter when using models that assume axons are straight \cite{Nilsson2012}. 

Budde et al.\ \cite{Budde2010} use \ac{MC} simulations to investigate the effect of neurite beading, showing that beading is sufficient to explain the decrease in \ac{ADC} after ischaemic stroke. Numerical phantoms consisting of straight cylinders with increasing amounts of beading introduced are simulated, showing a decrease in \ac{ADC} in both the intra and extracellular spaces with increased beading. 

Lin et al.\ \cite{Lin2016} investigate the effect of \ac{TBI} on \ac{dMRI} derived parameters.
Using a numerical phantom consisting of straight cylinders representing axons and ellipsoids representing glial cells, the effects of \ac{TBI} are investigated by varying various parameters such as the size of the glial cells, the permeability of the cylinders and the spacing of the cylinders \cite{Lin2016}. 
Using this technique, Lin et al.\ conclude that the inconsistencies amongst previous \ac{dMRI} based \ac{TBI} studies \cite{Huisman2004,Bazarian2007,Rutgers2008} are due to differences in the timing between the onset of \ac{TBI} and the diffusion measurement, arguing that different processes drive the \ac{TBI} at different timings, leading to different \ac{dMRI} characteristics. 

Lin et al.\ \cite{Lin2017} similarly investigate the effect of myelin water exchange on various \ac{dMRI} derived parameters. In this work, their representation of \ac{WM} is slightly different, choosing nested cylinders to represent the intra-axonal and myelin-water compartments.
Using \ac{MC} simulations on these cylinders, they show correlations between \ac{dMRI} derived parameters such as \ac{ADC} and \ac{FA} and the \acl{TE}.

Lam et al.\ \cite{Lam2015} produce an empirical model of the extra axonal space using a series of \ac{MC} simulations based on both regularly and randomly packed cylinders. The model is based on the diffusion spectrum \cite{Stepisnik1993}, modelling diffusion in densely packed cylinders as diffusion in a series of pores with a small chance of exchange between the pores.
The empirical model agrees closely with \ac{MC} simulated data.

Some studies combine analytical solutions of the Bloch-Torrey equation and \ac{MC} simulations.
Rensonnet et al.\ \cite{Rensonnet2015} use this combined simulation to synthesise signals for parallel and crossing cylinders.
The intracellular component is modelled using an analytical solution for diffusion within a cylinder based on Grebenkov's multiple correlation function approach \cite{Grebenkov2008}.
The extracellular compartment, which is much more complex geometrically, is simulated using Monte-Carlo simulations.
This hybrid approach yields simulation results which are indistinguishable from pure \ac{MC} simulation whilst being quicker and more precise than a purely \ac{MC} approach \cite{Rensonnet2015}. 

In a further study, Rensonnet et al.\ \cite{Rensonnet2017} use this approach to assess the validity of the superposition approximation of crossing fascicles (i.e. that the total signal from crossing fascicles is the sum of the signal from each fascicle independently).
They are able to show that the signal differences between the superposition approximation and a full simulation of interwoven fascicles is small enough compared to typical noise levels in clinical \ac{dMRI} data, that the superposition approximation is sufficient to describe the signal.
A drawback to this hybrid approach is that the intra and extracellular compartments are treated as distinct, non-interacting compartments, meaning that membrane permeability is not accounted for.

An emerging application for \ac{dMRI} simulations in the direct computational modelling of microstructure.
The first example found for this type of modelling is actually the 2010 work by Nilsson et al. \cite{Nilsson2010} mentioned above for evaluating the K\"arger model.
In recent years however, this idea has reemerged, partially thanks to the popularity of machine learning and emergence of MR fingerprinting.

One area of application these approaches have found is in the estimation of axonal permeability. Nedjati-Gilani et al.\ \cite{Nedjati-Gilani2017} use a machine learning technique known as random forest regression to learn the relationship between \ac{dMRI} signal and microstructural parameters. They simulate diffusion using Camino in a range parallel cylinder substrates with different microstructural parameters including membrane permeability to build a dataset to train the random forest regression.
The random forest regression is shown to estimate membrane permeability well, performing better than the K\"arger model and an application to \ac{MS} is presented, showing \emph{in vivo} results consistent with pathology.

Palombo et al.\ \cite{Palombo2018a} verify this method using a cuprizone treated \emph{in vivo} mouse model. Cuprizone is a well known mouse model of \ac{WM} demyelination, which is important as demyelination is hypothesised to affect axonal permeability.
The random forest approach achieves accurate and robust estimation of microstructural parameters which match expected microstructure changes from electron microscopy and gains more specific information that typical \ac{dMRI} measures such as \ac{ADC} and \ac{FA}. 

Hill et al.\ \cite{Hill2018} extend this work to use a deep \ac{NN} in place of the random forest regression. They are able to show that the \ac{NN} outperforms the random forest approach and an application in \emph{in vivo} mice estimates microstructural parameters in the biologically plausible range.

Rensonnet et al.\ \cite{Rensonnet2018} also attempt to use computational models to directly estimate microstructural parameters using \ac{dMRI} simulations.
Using the hybrid approach mentioned above \cite{Rensonnet2015}, they generate a dictionary of \ac{dMRI} simulation signals for various combinations of microstructural parameters and crossing fascicles.
Measured signals are then compared against this dictionary to find the entry that most closely matches the measured signal to get an estimate of the microstructural parameters.
They show that their approach achieves accurate and robust estimates of microstructural parameters and shows good correspondence with histology compared to traditional closed-form models when applied to an \emph{in vivo} mouse model of spinal cord injury. 



\section{\ac{GPU} accelerated \ac{MC} simulations}
\label{sec:review_gpu}
There have been a couple of studies attempting to modify \ac{MC} \ac{dMRI} simulations for the \ac{GPU}.
The first, by Waudby and Christodoulou \cite{Waudby2011} implements a simple random walk on the \ac{GPU}, with a rejection sampling scheme to handle substrate boundaries.
In this case, a step crossing a boundary is ignored and no step is taken rather than being reflected.

Unlike other geometries studied in this report, the Waudby and Christodoulou work uses a binary representation for simple shapes, meaning that the collision check is as straightforward as checking whether a spin moves into a region of space that is disallowed.
One downside of this approach is that complex geometries cannot be easily represented in this binary manner.

Waudby and Christodoulou show that the \ac{GPU} implementation is able to replicate unoptimised \ac{CPU} and analytical solutions for simple geometries whilst achieving a 1000$\times$ speedup over the \ac{CPU} implementation.
It is mentioned, that with \ac{CPU} optimisation, this difference should reduce to around 20$\times$.

A second, more recent, \ac{GPU} accelerated \ac{dMRI} simulation has been reported by Nguyen et al.\ \cite{Nguyen2018}.
This implementation handles arbitrary meshes with two approaches, one with an octree acceleration scheme and one following a similar binary approach to Waudby and Christodoulou.
The octree scheme gives them a 45-65$\times$ acceleration over Camino with the binary \ac{GPU} version achieving a 2000$\times$ acceleration.
The binary representation in this work uses a uniform grid to divide the space.
Each cell in the grid is assigned a 1 or a 0 based on whether or not it is inside the mesh and a step is considered to have collided with the mesh if it steps from a cell with a 1 to a cell with a 0.

This approach enables them to achieve a massive speedup in their simulation, however, it is limited by the resolution of the grid and the size of the smallest features in the mesh.
Nguyen et al.\ show that if the resolution is not sufficient, the simulated signal will not accurately represent the signal from the true mesh.
For relatively small substrates, this is not a problem as the grid can be made fine enough, however for large and complex substrates, the memory requirements may become excessive.

Currently, the \ac{GPU} \ac{dMRI} simulator presented by Nguyen et al.\ is not publicly available. 


\section{Conclusions}
\label{sec:review_conclusions}
There has been significant work into the use of numerical phantoms in the simulation of \acl{dMRI} signals.
One thing which is common throughout most of the works is a simple model of \ac{WM}.
Typically, \ac{WM} is represented as a set of densely packed, straight, parallel cylinders, which oversimplifies the underlying complexity of the microstructure.
Lee et al.\ \cite{Lee2018a} use electron microscopy to reconstruct a 3D section of mouse corpus callosum, showing that real \ac{WM} contains a large amount of microstructural complexity, including orientation dispersion, undulation and diameter variations.

Generating \ac{WM} substrates which accurately represent real microstructure is important for the kinds of model validation studies mentioned in \Cref{sec:app_monte_carlo_numerical_phantoms} because if a model is validated using overly simplified simulations, it may not be very robust when applied to real data.

Realistic \ac{WM} representations are important for the kind of computational models mentioned in \Cref{sec:app_monte_carlo_numerical_phantoms} for similar reasons.
Another element which is particularly important for building the training datasets or dictionaries for these kinds of computational models is controllability.
The \ac{WM} numerical phantoms need to be realistic, but also must be able to be generated in a controlled manner so that we can generate substrates covering the relevant ranges of microstructural parameters needed to build robust computational models.

These are the main driving reasons behind the work presented in \Cref{sec:config} which aims to build these realistic \ac{WM} substrates with controllable morphology. 


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
